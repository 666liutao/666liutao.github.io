(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{528:function(e,t,a){"use strict";a.r(t);var s=a(6),n=Object(s.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h2",{attrs:{id:"概述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#概述"}},[e._v("#")]),e._v(" 概述")]),e._v(" "),a("ul",[a("li",[e._v("JDBC 使用 Statement 作为 SQL 语句的执行器。")]),e._v(" "),a("li",[e._v("Statement 通过 Connection.createStatement() 方法创建，一共支持以下6种方式执行 SQL 语句：\n"),a("ul",[a("li",[e._v("execute()")]),e._v(" "),a("li",[e._v("executeUpdate()")]),e._v(" "),a("li",[e._v("executeQuery()")]),e._v(" "),a("li",[e._v("executeLargeUpdate()")]),e._v(" "),a("li",[e._v("executeBatch()")]),e._v(" "),a("li",[e._v("executeLargeBatch()")])])])]),e._v(" "),a("h2",{attrs:{id:"_1-execute"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-execute"}},[e._v("#")]),e._v(" 1. execute()")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("boolean execute(String sql) throws SQLException;\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("ul",[a("li",[e._v("execute() 方法，提供了一个通用的接口去执行 SQL 语句，它能够接受任何 SQL 语句，返回的布尔值是判断是否有 ResultSet 返回。")]),e._v(" "),a("li",[e._v("Statement 提供了一下两个接口去获得 execute() 真正的执行结果（分别针对 executeUpdate() 和 executeQuery() 的情况）：")])]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("ResultSet getResultSet() throws SQLException;\n \nint getUpdateCount() throws SQLException;\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br")])]),a("h2",{attrs:{id:"_2-executeupdate"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-executeupdate"}},[e._v("#")]),e._v(" 2. executeUpdate()")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("int executeUpdate(String sql) throws SQLException;\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("ul",[a("li",[e._v("executeUpdate() 方法，是用来执行 DML 语句中的 INSERT, DELETE, UPDATE，返回受这个 DML 语句影响的行数。")]),e._v(" "),a("li",[e._v("但是，这个方法，在执行 SELECT 语句，或者是 DDL、DCL 语句也不会出错，并且能够正确执行，返回结果是0。")])]),e._v(" "),a("h2",{attrs:{id:"_3-executequery"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-executequery"}},[e._v("#")]),e._v(" 3. executeQuery()")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("ResultSet executeQuery(String sql) throws SQLException;\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("ul",[a("li",[e._v("executeQuery() 方法，是用来执行 DML 语句中的 SELECT，返回 ResultSet 结果集。")]),e._v(" "),a("li",[e._v("这个方法在执行非 SELECT 的 SQL 语句时，会抛出异常，执行的内容不会影响数据库。")])]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("java.sql.SQLException: query does not return ResultSet\n    at org.sqlite.jdbc3.JDBC3Statement.executeQuery(JDBC3Statement.java:85)\n    at com.gerrard.demo.StatementDemo.main(StatementDemo.java:20)\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br")])]),a("h2",{attrs:{id:"_4-executelargeupdate"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-executelargeupdate"}},[e._v("#")]),e._v(" 4. executeLargeUpdate()")]),e._v(" "),a("ul",[a("li",[e._v("在 Java8 中，还新增了 executeLargeUpdate() 方法，针对更新行数超过 Integer.MAX_VALUE 的情况：")])]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('default long executeLargeUpdate(String sql) throws SQLException {\n     throw new UnsupportedOperationException("executeLargeUpdate not implemented");\n}\n')])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br")])]),a("ul",[a("li",[e._v("executeLargeUpdate() 方法适用的范围很小，返回结果是 long 型，接受的 SQL 语句与 executeUpdate() 完全相同。")]),e._v(" "),a("li",[e._v("很多数据库厂商都没有开放对 executeLargeUpdate() 的支持。")])]),e._v(" "),a("h2",{attrs:{id:"_5-executebatch"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-executebatch"}},[e._v("#")]),e._v(" 5. executeBatch()")]),e._v(" "),a("ul",[a("li",[e._v("Statement 还提供了 executeBatch() 方法来支持 SQL 语句的批处理：")])]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("int[] executeBatch() throws SQLException;\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("ul",[a("li",[e._v("使用 executeBatch() 方法，首先需要通过 addBatch() 方法注入 SQL 语句：")])]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("void addBatch( String sql ) throws SQLException;\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("ul",[a("li",[e._v("这里需要注意的是，executeBatch() 不支持 SELECT 语句。")])]),e._v(" "),a("h2",{attrs:{id:"_6-executelargebatch"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-executelargebatch"}},[e._v("#")]),e._v(" 6. executeLargeBatch()")]),e._v(" "),a("ul",[a("li",[e._v("与 executeUpdate() 类似，Java8 提供了 executeLargeBatch() 方法增强批量更新。")]),e._v(" "),a("li",[e._v("批处理的时候，任意一条 SQL 语句返回值大于 Integer.MAX_VALUE，就要使用这个方法：")])]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('default long[] executeLargeBatch() throws SQLException {\n       throw new UnsupportedOperationException("executeLargeBatch not implemented");\n}\n')])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br")])]),a("h2",{attrs:{id:"代码示例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#代码示例"}},[e._v("#")]),e._v(" 代码示例")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('package com.liutao.demo;\n \nimport com.liutao.util.Connector;\nimport com.liutao.util.DriverLoader;\n \nimport java.sql.Connection;\nimport java.sql.ResultSet;\nimport java.sql.SQLException;\nimport java.sql.Statement;\n \npublic final class StatementDemo {\n \n    public static void main(String[] args) {\n \n        String querySql = "SELECT * from STUDENT";\n        String updateSql1 = "UPDATE STUDENT SET STUDENT_PASSWORD = \'123456\' WHERE STUDENT_PASSWORD = \'123456\'";\n        String updateSql2 = "UPDATE STUDENT SET STUDENT_PASSWORD = \'223456\' WHERE STUDENT_PASSWORD = \'223456\'";\n \n        DriverLoader.loadSqliteDriver();\n        try (Connection conn = Connector.getSqlConnection();\n             Statement stmt = conn.createStatement()) {\n \n            // execute\n            boolean hasResult = stmt.execute(updateSql1);\n            if (hasResult) {\n                System.out.println("Execute query success");\n            } else {\n                System.out.println("Execute update success, affect" + stmt.getUpdateCount() + " rows");\n            }\n \n            // executeUpdate\n            int rowCount1 = stmt.executeUpdate(updateSql1);\n            System.out.println("Affected " + rowCount1 + " rows");\n \n            // executeQuery\n            try (ResultSet rs = stmt.executeQuery(querySql)) {\n                int counter = 0;\n                while (rs.next()) {\n                    counter++;\n                }\n                System.out.println(counter + " students in all");\n            }\n \n            // executeBatch\n            stmt.addBatch(updateSql1);\n            stmt.addBatch(updateSql2);\n            stmt.addBatch(updateSql1);\n            int[] results = stmt.executeBatch();\n            for (int result : results) {\n                System.out.println("Affected " + result + " rows");\n            }\n \n            // executeLargeUpdate\n            stmt.executeLargeUpdate(updateSql1);\n \n        } catch (SQLException e) {\n            e.printStackTrace();\n        }\n    }\n}\n')])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br"),a("span",{staticClass:"line-number"},[e._v("9")]),a("br"),a("span",{staticClass:"line-number"},[e._v("10")]),a("br"),a("span",{staticClass:"line-number"},[e._v("11")]),a("br"),a("span",{staticClass:"line-number"},[e._v("12")]),a("br"),a("span",{staticClass:"line-number"},[e._v("13")]),a("br"),a("span",{staticClass:"line-number"},[e._v("14")]),a("br"),a("span",{staticClass:"line-number"},[e._v("15")]),a("br"),a("span",{staticClass:"line-number"},[e._v("16")]),a("br"),a("span",{staticClass:"line-number"},[e._v("17")]),a("br"),a("span",{staticClass:"line-number"},[e._v("18")]),a("br"),a("span",{staticClass:"line-number"},[e._v("19")]),a("br"),a("span",{staticClass:"line-number"},[e._v("20")]),a("br"),a("span",{staticClass:"line-number"},[e._v("21")]),a("br"),a("span",{staticClass:"line-number"},[e._v("22")]),a("br"),a("span",{staticClass:"line-number"},[e._v("23")]),a("br"),a("span",{staticClass:"line-number"},[e._v("24")]),a("br"),a("span",{staticClass:"line-number"},[e._v("25")]),a("br"),a("span",{staticClass:"line-number"},[e._v("26")]),a("br"),a("span",{staticClass:"line-number"},[e._v("27")]),a("br"),a("span",{staticClass:"line-number"},[e._v("28")]),a("br"),a("span",{staticClass:"line-number"},[e._v("29")]),a("br"),a("span",{staticClass:"line-number"},[e._v("30")]),a("br"),a("span",{staticClass:"line-number"},[e._v("31")]),a("br"),a("span",{staticClass:"line-number"},[e._v("32")]),a("br"),a("span",{staticClass:"line-number"},[e._v("33")]),a("br"),a("span",{staticClass:"line-number"},[e._v("34")]),a("br"),a("span",{staticClass:"line-number"},[e._v("35")]),a("br"),a("span",{staticClass:"line-number"},[e._v("36")]),a("br"),a("span",{staticClass:"line-number"},[e._v("37")]),a("br"),a("span",{staticClass:"line-number"},[e._v("38")]),a("br"),a("span",{staticClass:"line-number"},[e._v("39")]),a("br"),a("span",{staticClass:"line-number"},[e._v("40")]),a("br"),a("span",{staticClass:"line-number"},[e._v("41")]),a("br"),a("span",{staticClass:"line-number"},[e._v("42")]),a("br"),a("span",{staticClass:"line-number"},[e._v("43")]),a("br"),a("span",{staticClass:"line-number"},[e._v("44")]),a("br"),a("span",{staticClass:"line-number"},[e._v("45")]),a("br"),a("span",{staticClass:"line-number"},[e._v("46")]),a("br"),a("span",{staticClass:"line-number"},[e._v("47")]),a("br"),a("span",{staticClass:"line-number"},[e._v("48")]),a("br"),a("span",{staticClass:"line-number"},[e._v("49")]),a("br"),a("span",{staticClass:"line-number"},[e._v("50")]),a("br"),a("span",{staticClass:"line-number"},[e._v("51")]),a("br"),a("span",{staticClass:"line-number"},[e._v("52")]),a("br"),a("span",{staticClass:"line-number"},[e._v("53")]),a("br"),a("span",{staticClass:"line-number"},[e._v("54")]),a("br"),a("span",{staticClass:"line-number"},[e._v("55")]),a("br"),a("span",{staticClass:"line-number"},[e._v("56")]),a("br"),a("span",{staticClass:"line-number"},[e._v("57")]),a("br"),a("span",{staticClass:"line-number"},[e._v("58")]),a("br"),a("span",{staticClass:"line-number"},[e._v("59")]),a("br"),a("span",{staticClass:"line-number"},[e._v("60")]),a("br")])])])}),[],!1,null,null,null);t.default=n.exports}}]);