(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{526:function(e,t,a){"use strict";a.r(t);var n=a(6),s=Object(n.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h2",{attrs:{id:"_1-preparedstatement"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-preparedstatement"}},[e._v("#")]),e._v(" 1. PreparedStatement")]),e._v(" "),a("ul",[a("li",[e._v("PreparedStatement 是 Statement 的子接口，它支持以下4种执行 SQL 的方式：\n"),a("ul",[a("li",[e._v("execute()")]),e._v(" "),a("li",[e._v("executeUpdate()")]),e._v(" "),a("li",[e._v("executeQuery()")]),e._v(" "),a("li",[e._v("executeLargeUpdate()")])])]),e._v(" "),a("li",[e._v("同时，PreparedStatement 提供了一系列的 setXxx(int index, Xxx value) 来支持对于 ？ 占位符的替换。Xxx 是占位符的数据类型。")]),e._v(" "),a("li",[e._v("如果不确定数据类型，可以通过 setObject() 方法来传入数据。")]),e._v(" "),a("li",[e._v("PreparedStatement 通过 Connection.createPreparedStatement(String sql) 方法创建，主要用来反复执行一条结构相似的 SQL 语句。")])]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("INSERT INTO STUDENT (STUDENT_NAME, STUDENT_PASSWORD) VALUES (?, ?);\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("h3",{attrs:{id:"preparedstatement的优势"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#preparedstatement的优势"}},[e._v("#")]),e._v(" PreparedStatement的优势")]),e._v(" "),a("ul",[a("li",[e._v("通过预编译 SQL 语句的方式（即创建 PreparedStatement 的时候，就将 SQL语句传递进去），大大降低了多次执行相似的 SQL 语句的效率。")]),e._v(" "),a("li",[e._v("需要传递参数的时候，无需拼接 SQL 语句，降低了编程的复杂度。")]),e._v(" "),a("li",[e._v("防止 SQL 注入。")])]),e._v(" "),a("h2",{attrs:{id:"_2-callablestatement"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-callablestatement"}},[e._v("#")]),e._v(" 2. CallableStatement")]),e._v(" "),a("ul",[a("li",[e._v("在大型关系型数据库中，有一组为了完成特定功能的 SQL 语句集被称为存储过程（Stored Procedure），它是数据库中的对象。")]),e._v(" "),a("li",[e._v("JDBC 使用 CallableStatement 对象，完成对存储过程的操作。")]),e._v(" "),a("li",[e._v("CallableStatement 通过 Connection.prepareCall(String sql)  方法创建。")]),e._v(" "),a("li",[e._v("与 PreparedStatement 相似，提供了一系列的 setXxx(int index, Xxx value) 来支持存储过程的入参传递。")]),e._v(" "),a("li",[e._v("同样的，不确定数据类型，可以通过 setObject() 方法来传入数据。")]),e._v(" "),a("li",[e._v("另外，存储过程是可以有输出的，通过 registerOutParameter(int parameterIndex, int sqlType) 方法来注册输出项。")])]),e._v(" "),a("h3",{attrs:{id:"示例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#示例"}},[e._v("#")]),e._v(" 示例")]),e._v(" "),a("p",[e._v("假设现在有如下存储过程定义：")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("create procedure add_pro(a int, b int, out sum int)\nbegin\nset sum = a + b;\nend\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br")])]),a("p",[e._v("通过如下代码调用：")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('package com.liutao.executor;\n \nimport com.liutao.constants.ErrorCode;\nimport com.liutao.exception.JdbcSampleException;\nimport com.liutao.util.Connector;\nimport com.liutao.util.DriverLoader;\n \nimport java.sql.CallableStatement;\nimport java.sql.Connection;\nimport java.sql.SQLException;\nimport java.sql.Types;\n \npublic final class SqlExecutorCallableStatement {\n \n \n    /*\n       create procedure add_pro(a int, b int, out sum int)\n       begin\n       set sum = a + b;\n       end\n     */\n    public static void callProcedure() {\n        DriverLoader.loadSqliteDriver();\n        try (Connection conn = Connector.getSqlConnection();\n             CallableStatement cstmt = conn.prepareCall("{call add_pro(?, ?)}")) {\n \n            cstmt.setObject(1, "1");\n            cstmt.setObject(2, "2");\n            cstmt.registerOutParameter(3, Types.INTEGER);\n \n            cstmt.execute();\n            System.out.println("Result:" + cstmt.getObject(3));\n        } catch (SQLException e) {\n            throw new JdbcSampleException(ErrorCode.CALL_PROCEDURE_FAILURE, e.getMessage());\n        }\n    }\n \n    public static void main(String[] args) {\n        callProcedure();\n    }\n}\n')])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br"),a("span",{staticClass:"line-number"},[e._v("9")]),a("br"),a("span",{staticClass:"line-number"},[e._v("10")]),a("br"),a("span",{staticClass:"line-number"},[e._v("11")]),a("br"),a("span",{staticClass:"line-number"},[e._v("12")]),a("br"),a("span",{staticClass:"line-number"},[e._v("13")]),a("br"),a("span",{staticClass:"line-number"},[e._v("14")]),a("br"),a("span",{staticClass:"line-number"},[e._v("15")]),a("br"),a("span",{staticClass:"line-number"},[e._v("16")]),a("br"),a("span",{staticClass:"line-number"},[e._v("17")]),a("br"),a("span",{staticClass:"line-number"},[e._v("18")]),a("br"),a("span",{staticClass:"line-number"},[e._v("19")]),a("br"),a("span",{staticClass:"line-number"},[e._v("20")]),a("br"),a("span",{staticClass:"line-number"},[e._v("21")]),a("br"),a("span",{staticClass:"line-number"},[e._v("22")]),a("br"),a("span",{staticClass:"line-number"},[e._v("23")]),a("br"),a("span",{staticClass:"line-number"},[e._v("24")]),a("br"),a("span",{staticClass:"line-number"},[e._v("25")]),a("br"),a("span",{staticClass:"line-number"},[e._v("26")]),a("br"),a("span",{staticClass:"line-number"},[e._v("27")]),a("br"),a("span",{staticClass:"line-number"},[e._v("28")]),a("br"),a("span",{staticClass:"line-number"},[e._v("29")]),a("br"),a("span",{staticClass:"line-number"},[e._v("30")]),a("br"),a("span",{staticClass:"line-number"},[e._v("31")]),a("br"),a("span",{staticClass:"line-number"},[e._v("32")]),a("br"),a("span",{staticClass:"line-number"},[e._v("33")]),a("br"),a("span",{staticClass:"line-number"},[e._v("34")]),a("br"),a("span",{staticClass:"line-number"},[e._v("35")]),a("br"),a("span",{staticClass:"line-number"},[e._v("36")]),a("br"),a("span",{staticClass:"line-number"},[e._v("37")]),a("br"),a("span",{staticClass:"line-number"},[e._v("38")]),a("br"),a("span",{staticClass:"line-number"},[e._v("39")]),a("br"),a("span",{staticClass:"line-number"},[e._v("40")]),a("br"),a("span",{staticClass:"line-number"},[e._v("41")]),a("br")])])])}),[],!1,null,null,null);t.default=s.exports}}]);