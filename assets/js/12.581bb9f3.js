(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{517:function(s,t,e){"use strict";e.r(t);var a=e(6),i=Object(a.a)({},(function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("div",{staticClass:"custom-block tip"},[e("ul",[e("li",[s._v("vuepress 简洁易用")]),s._v(" "),e("li",[s._v("Github Pages配合github好管理")]),s._v(" "),e("li",[s._v("GithubAction 自动发布")])])]),s._v(" "),e("h1",{attrs:{id:"_1-背景"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-背景"}},[s._v("#")]),s._v(" 1. 背景")]),s._v(" "),e("ul",[e("li",[s._v("由于之前使用的自动构建发布工具travis开始收费了，所以打算使用Github Action替代")])]),s._v(" "),e("h1",{attrs:{id:"_2-工具说明"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-工具说明"}},[s._v("#")]),s._v(" 2. 工具说明")]),s._v(" "),e("ul",[e("li",[s._v("VuePress: 是一款Vue驱动的静态网站生成器,可以方便的快速搭建自己的静态博客")]),s._v(" "),e("li",[s._v("Github Pages: 是一个免费的静态网站托管服务，由 GitHub 提供。特点是 方便快捷，无需备案，免费域名，也可支持自定义域名。")]),s._v(" "),e("li",[s._v("Github Action: github的持续集成服务，使用说明: "),e("a",{attrs:{href:"https://docs.github.com/zh/actions",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方文档"),e("OutboundLink")],1)])]),s._v(" "),e("h1",{attrs:{id:"_3-搭建过程"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-搭建过程"}},[s._v("#")]),s._v(" 3. 搭建过程")]),s._v(" "),e("h2",{attrs:{id:"_3-1-创建-github-pages-站点"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-创建-github-pages-站点"}},[s._v("#")]),s._v(" 3.1 创建 GitHub Pages 站点")]),s._v(" "),e("ul",[e("li",[s._v("创建项目仓库，仓库命名无限制，本博客的仓库名称与访问地址一致，为 liutao1006.github.io")]),s._v(" "),e("li",[s._v("创建两个分支\n"),e("ul",[e("li",[s._v("master : 默认分支，用于保存编译构建后的静态页面，无需手动管理")]),s._v(" "),e("li",[s._v("doc :  文档分支，用于保存博客文档，以及vuepress的配置。")])])]),s._v(" "),e("li",[s._v("将仓库设置为站点,方式如下图： "),e("a",{attrs:{href:"https://docs.github.com/zh/pages/getting-started-with-github-pages/configuring-a-publishing-source-for-your-github-pages-site",target:"_blank",rel:"noopener noreferrer"}},[s._v("也可参考官方文档"),e("OutboundLink")],1),s._v(" "),e("ul",[e("li",[e("img",{attrs:{src:"https://raw.githubusercontent.com/liutao1996/images/main/note/CICD/github%E9%85%8D%E7%BD%AE%E7%AB%99%E7%82%B9%E9%A1%B5%E9%9D%A2.jpg",alt:"img"}})])])])]),s._v(" "),e("h2",{attrs:{id:"_3-2-vuepress工程"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-vuepress工程"}},[s._v("#")]),s._v(" 3.2 vuepress工程")]),s._v(" "),e("ul",[e("li",[s._v("关于vuepress的配置不做描述，"),e("a",{attrs:{href:"https://vuepress.vuejs.org/zh/guide/page.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("请参考官方文档"),e("OutboundLink")],1)]),s._v(" "),e("li",[s._v("如若进行配置过于繁琐，可使用本博客的模板，"),e("a",{attrs:{href:"https://github.com/liutao1996/liutao1996.github.io/releases/tag/vuepress-blog",target:"_blank",rel:"noopener noreferrer"}},[s._v("工程代码位置"),e("OutboundLink")],1)]),s._v(" "),e("li",[s._v("下载后，进行个人定制化配置，如站点名称，图标等，然后将该工程代码，推送至 doc 分支")])]),s._v(" "),e("h2",{attrs:{id:"_3-3-github-action配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-github-action配置"}},[s._v("#")]),s._v(" 3.3 Github Action配置")]),s._v(" "),e("h3",{attrs:{id:"deploy-yml"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#deploy-yml"}},[s._v("#")]),s._v(" deploy.yml")]),s._v(" "),e("ul",[e("li",[s._v("GitHub Actions 的配置文件叫做 workflow 文件，存放在代码仓库的.github/workflows目录，后缀统一为 yml")]),s._v(" "),e("li",[s._v("在doc分支下，创建 .github/workflows/deploy.yml")]),s._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/liutao1996/liutao1996.github.io/blob/doc/.github/workflows/deploy.yml",target:"_blank",rel:"noopener noreferrer"}},[s._v("配置文件样例"),e("OutboundLink")],1)])]),s._v(" "),e("h3",{attrs:{id:"token配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#token配置"}},[s._v("#")]),s._v(" token配置")]),s._v(" "),e("ul",[e("li",[s._v("deploy.yml中存在一个  secrets.ACCESS_TOKEN 变量，该变量是仓库访问的token，用于工作流向仓库推送代码，")]),s._v(" "),e("li",[s._v("创建token具体操作如下:\n"),e("ul",[e("li",[s._v("点击头像 ---\x3e Setting ---\x3e Developer settings ---\x3e Personal access tokens ---\x3e Generate new token(classic)")]),s._v(" "),e("li",[s._v("创建的token名字要和deploy.yml中的变量保持一致，这里为ACCESS_TOKEN，有效期建议为永久(No expiration)")]),s._v(" "),e("li",[s._v("权限勾选 repo 以及 workflows 即可")])])])]),s._v(" "),e("h1",{attrs:{id:"_4-实际使用"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-实际使用"}},[s._v("#")]),s._v(" 4. 实际使用")]),s._v(" "),e("ul",[e("li",[s._v("本地IDEA拉取仓库代码，分支切换至 doc")]),s._v(" "),e("li",[s._v("在 docs/views 目录 创建自己的第一篇博客文章(markdown格式)")]),s._v(" "),e("li",[s._v("最后提交，推送至远程仓库，等待工作流构建完毕")]),s._v(" "),e("li",[s._v("访问 liutao1996.github.io 即可")])]),s._v(" "),e("h1",{attrs:{id:"_5-问题"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-问题"}},[s._v("#")]),s._v(" 5.问题")]),s._v(" "),e("h2",{attrs:{id:"_5-1-如果出现构建失败"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-如果出现构建失败"}},[s._v("#")]),s._v(" 5.1 如果出现构建失败")]),s._v(" "),e("ul",[e("li",[s._v("查看构建失败的日志，位置：Actions, 点击最新的构建失败的工作流，点击Jobs-build, 即可查看构建过程中的日志")]),s._v(" "),e("li",[s._v("举例，本博客在构建出现以下问题：")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("yarn install v1.22.22\nwarning package-lock.json found. Your project contains lock files generated by tools other than Yarn. It is advised not to mix package managers in order to avoid resolution inconsistencies caused by unsynchronized lock files. To clear this warning, remove package-lock.json.\n[1/4] Resolving packages...\n[2/4] Fetching packages...\nerror Error: certificate has expired\n    at TLSSocket.onConnectSecure (_tls_wrap.js:1515:34)\n    at TLSSocket.emit (events.js:400:28)\n    at TLSSocket._finishInit (_tls_wrap.js:937:8)\n    at TLSWrap.ssl.onhandshakedone (_tls_wrap.js:709:12)\ninfo Visit https://yarnpkg.com/en/docs/cli/install for documentation about this command.\nError: Process completed with exit code 1.\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br")])]),e("ul",[e("li",[s._v("该问题的原因是证书过期导致 https访问失败，那么对应的解决方案是忽略tls证书验证即可")]),s._v(" "),e("li",[s._v("具体操作:deploy.yml增加以下构建步骤即可")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('      # 避免出现HTTPS 证书验证失败\n      - name:\n        run: yarn config set "strict-ssl" false -g\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h2",{attrs:{id:"_5-2-依赖问题"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-依赖问题"}},[s._v("#")]),s._v(" 5.2 依赖问题")]),s._v(" "),e("ul",[e("li",[s._v("如果package.json中依赖发生变化,需要将deploy.yml中使用缓存依赖的步骤去除，待执行一次后，再重新加上")]),s._v(" "),e("li",[s._v("去除的步骤如下")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("      # 缓存 node_modules,如果package.json中依赖发生变化，建议将此步骤先移除，否则构建时不会刷新依赖\n      - name: Cache dependencies\n        uses: actions/cache@v2\n        id: yarn-cache\n        with:\n          path: |\n            **/node_modules\n          key: ${{ runner.os }}-yarn-${{ hashFiles('**/yarn.lock') }}\n          restore-keys: |\n            ${{ runner.os }}-yarn-\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])]),e("h1",{attrs:{id:"_6-扩展"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-扩展"}},[s._v("#")]),s._v(" 6. 扩展")]),s._v(" "),e("h2",{attrs:{id:"_6-1-增加评论功能"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-增加评论功能"}},[s._v("#")]),s._v(" 6.1 增加评论功能")]),s._v(" "),e("ul",[e("li",[s._v("经尝试，在使用vssue时，是无法成功使用评论插件的，原因如下：")]),s._v(" "),e("li",[s._v("github:\n"),e("ul",[e("li",[s._v("当使用github作为平台时，会出现跨域问题，可使用代理方式解决，由于vusse内置代理已不可用，需更换为自己的cros代理")])])]),s._v(" "),e("li",[s._v("gitee:\n"),e("ul",[e("li",[s._v("使用gitee作为平台时，会出现无效的登录回调地址")]),s._v(" "),e("li",[s._v("原因:由于OAuth应用的回调地址，要和你发送请求的redirect_uri后面带的那一串地址要一样，动态的，且gitee并不打算解决此问题")])])])]),s._v(" "),e("h3",{attrs:{id:"方法1-使用vssue"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#方法1-使用vssue"}},[s._v("#")]),s._v(" 方法1: 使用vssue")]),s._v(" "),e("ul",[e("li",[s._v("在package.json中引入插件依赖")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('"@vssue/api-github-v4": "^1.4.7",\n"@vssue/vuepress-plugin-vssue": "^1.4.8",\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("ul",[e("li",[s._v("在.vuepress/config.js中进行插件配置")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("module.exports = {\n    plugins: [\n        [\n            '@vssue/vuepress-plugin-vssue',\n            {\n                // 设置 `platform` 而不是 `api`\n                platform: 'github-v4',// v3的platform是github，v4的是github-v4\n                // 其他的 Vssue 配置\n                owner: 'liutao1996',    // 仓库的拥有者名称\n                repo: 'liutao1996.github.io', // 存储评论的仓库名称\n                clientId: 'Ov23liG11NcHSiAZOq5R', // 刚保存下来的 Client ID\n                clientSecret: 'xxxxxxxxxxxxxxxxxxxxx', // 刚才保存下来的 Client secrets\n                autoCreateIssue: true // 自动创建 Issue\n            }\n        ],\n   ]\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br")])]),e("ul",[e("li",[s._v("clientId及clientSecret的生成：\n"),e("ul",[e("li",[s._v("点击头像 ---\x3e Setting ---\x3e Developer settings ---\x3e OAuth Apps ---\x3e New OAuth App")]),s._v(" "),e("li",[s._v("Homepage URL填写博客首页地址: https://liutao1996.github.io/")]),s._v(" "),e("li",[s._v("Authorization callback URL填写博客首页地址: https://liutao1996.github.io/")]),s._v(" "),e("li",[s._v("提交")])])]),s._v(" "),e("li",[s._v("使用: 在需要开启评论的markdown文章末尾，加一行"),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v(" <Vssue/>\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("a",{attrs:{href:"https://vssue.js.org/zh/guide/vuepress.html#%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95",target:"_blank",rel:"noopener noreferrer"}},[s._v("vssue配置静态网站官方文档"),e("OutboundLink")],1)])]),s._v(" "),e("h4",{attrs:{id:"该方法遇到的问题"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#该方法遇到的问题"}},[s._v("#")]),s._v(" 该方法遇到的问题")]),s._v(" "),e("ul",[e("li",[s._v("https://github.com/meteorlxy/vssue/issues/131")]),s._v(" "),e("li",[s._v("速率限制: https://docs.github.com/zh/graphql/overview/rate-limits-and-node-limits-for-the-graphql-api?apiVersion=2022-11-28")]),s._v(" "),e("li",[s._v("目前使用过程中发现，在请求https://api.github.com/graphql时，出现403，原因是请求体中的X-Ratelimit-Limit=0，估计是vssue的问题")]),s._v(" "),e("li",[s._v("gitee:\n"),e("ul",[e("li",[s._v("gitee OAuth 授权请求请求范围无效、未知或格式不正确, 这种情况是授权范围不够，需要授权 user_info,issues,notes")])])])]),s._v(" "),e("h3",{attrs:{id:"方法2-使用gitalk"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#方法2-使用gitalk"}},[s._v("#")]),s._v(" 方法2: 使用gitalk")]),s._v(" "),e("ul",[e("li",[s._v("https://cloud.tencent.com/developer/article/1533079")])]),s._v(" "),e("h2",{attrs:{id:"_6-2-seo的解决"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-seo的解决"}},[s._v("#")]),s._v(" 6.2 seo的解决")]),s._v(" "),e("ul",[e("li",[s._v("https://zhuanlan.zhihu.com/p/678324158")])]),s._v(" "),e("p",[s._v("参考文章:")]),s._v(" "),e("ul",[e("li",[s._v("https://zhuanlan.zhihu.com/p/58229299")]),s._v(" "),e("li",[s._v("https://zhuanlan.zhihu.com/p/393344955")]),s._v(" "),e("li",[s._v("https://zhuanlan.zhihu.com/p/647963756")]),s._v(" "),e("li",[s._v("https://zhuanlan.zhihu.com/p/93030651")]),s._v(" "),e("li",[s._v("https://blog.csdn.net/qq_43173415/article/details/117741139")])]),s._v(" "),e("Vssue")],1)}),[],!1,null,null,null);t.default=i.exports}}]);